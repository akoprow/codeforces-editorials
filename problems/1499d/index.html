<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"">
  <meta name="generator" content="Jekyll">

  <title>The Number of Pairs</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/codeforces-editorials/css/main.css">

  <link href="/codeforces-editorials/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>The Number of Pairs | Codeforces editorials</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="The Number of Pairs" />
<meta name="author" content="Adam Koprowski" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Codeforces editorials" />
<meta property="og:description" content="Codeforces editorials" />
<meta property="og:site_name" content="Codeforces editorials" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Number of Pairs" />
<script type="application/ld+json">
{"@type":"WebPage","url":"/codeforces-editorials/problems/1499d/","headline":"The Number of Pairs","author":{"@type":"Person","name":"Adam Koprowski"},"description":"Codeforces editorials","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SHM3SPE7F9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SHM3SPE7F9');
  </script>
</head>


<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/codeforces-editorials/">
    
    <h1>adam@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/codeforces-editorials/"><h2 class="header-link">Contests</h2></a>
<a href="/codeforces-editorials/problems"><h2 class="header-link">Problems</h2></a>
<a href="/codeforces-editorials/todo"><h2 class="header-link">TODO</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <div class="alert alert-primary" role="alert">
  
  <tiny>1499</tiny>D

  
  <a href="/codeforces-editorials/problems/1499d/">
    The Number of Pairs
  </a>
  <a href="https://codeforces.com/contest/1499/problem/D">
  [CF]
  </a>

  <a href="https://github.com/akoprow/competetive-programming/blob/master/src/codeforces/edu/edu106/1499d-the-number-of-pairs.kt">(Code)</a>

  <rating>R:2100 <meter min="800" max="3600" value="2100" /></rating>

  <labels>
  
  
    <span class="badge rounded-pill bg-warning text-dark">math</span>
  
    <span class="badge rounded-pill bg-warning text-dark">number theory</span>
  
  </labels>
</div>

<p>Firstly, let’s look at \(a\) and \(b\) in such a way that it is easy to reason about \(gcd\) and \(lcm\), namely, say \(a = g \cdot p\) and \(b = g \cdot q\) such that \(gcd(p, q) = 1\), i.e. they are co-prime.  It’s then easy to see that \(gcd(a, b) = g\) and \(lcm(a, b) = g \cdot p \cdot q\).  Let’s now look again at the original equation:</p>

\[c \cdot lcm(a, b) - d \cdot gcd(a, b) = x\]

\[c \cdot g \cdot p \cdot q - d \cdot g = x\]

\[g \cdot (c \cdot p \cdot q - d) = x\]

<p>Since \(g\) is a factor on the left hand side we conclude that \(x\) must be divisible by \(x\), so firstly let’s iterate through all divisors of \(x\) as candidates for \(g\).</p>

<p>Once we have a fixed \(g\):</p>

\[c \cdot p \cdot q = \frac{x}{g} + d\]

<p>and so again we see that \(\frac{x}{g} + d\) must be divisible by \(c\); if it’s not we can skip such a candidate.</p>

<p>Now finally we get:</p>

\[p \cdot q = \frac{\frac{x}{g} + d}{c}\]

<p>In other words we know what the product of \(p \cdot q\) should be equal to.  Recall that we can choose \(p\) and \(q\) any way we want provided that they are co-prime.  This means that any prime factor of \(p \cdot q\) must go to either \(p\) or \(q\), but not both.  In other words there are \(2^s\) ways to choose \(p\) and \(q\) where \(s\) is the number of prime factors of \(p \cdot q\).</p>

<p>The tricky bit is that if we naively use Eratosthenes sieve we have \(\sqrt{x}\) factors for \(x\) and for each we need \(log x\) time for a total of \(O(\sqrt{x}\ \log{x})\), which is not fast enough.</p>

<p>What we need to do is to precompute the number of prime factors for all numbers in the range we care about (i.e. up to \(2 \cdot 10^7\)).  Sieve gives us a smaller prime factor for every number.  Suppose we are looking at \(x\) with its smaller prime being \(p\).  We have two cases:</p>

<ul>
  <li>smaller prime of \(\frac{x}{p}\) is also \(p\), in which case \(x\) has as many prime factors as \(\frac{x}{p}\),</li>
  <li>or it has one more, if they are different.</li>
</ul>


      </section>
    </div>
  </div>

   <footer>
  <a href="https://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
    <span>
        <b>Adam Koprowski</b>
    </span>
    
    <span>© 2021</span>
  </a>
</footer>

  
</body>

</html>
