<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"">
  <meta name="generator" content="Jekyll">

  <title>Primitive Primes</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/codeforces-editorials/css/main.css">

  <link href="/codeforces-editorials/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Primitive Primes | Codeforces editorials</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Primitive Primes" />
<meta name="author" content="Adam Koprowski" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Codeforces editorials" />
<meta property="og:description" content="Codeforces editorials" />
<meta property="og:site_name" content="Codeforces editorials" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Primitive Primes" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Primitive Primes","url":"/codeforces-editorials/problems/1316c/","author":{"@type":"Person","name":"Adam Koprowski"},"description":"Codeforces editorials","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SHM3SPE7F9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SHM3SPE7F9');
  </script>
</head>


<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/codeforces-editorials/">
    
    <h1>adam@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/codeforces-editorials/"><h2 class="header-link">Contests</h2></a>
<a href="/codeforces-editorials/problems"><h2 class="header-link">Problems</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <div class="alert alert-primary" role="alert">
  
  <tiny>1316</tiny>C

  
  <a href="/codeforces-editorials/problems/1316c/">
    Primitive Primes
  </a>
  <a href="https://codeforces.com/contest/1316/problem/C">
  [CF]
  </a>

  <a href="https://github.com/akoprow/competetive-programming/blob/master/src/codeforces/other/codeCraft20/1316c-primitive-primes.kt">(Code)</a>

  <rating>R:1800 <meter min="800" max="3600" value="1800" /></rating>

  <labels>
  
  
    <span class="badge rounded-pill bg-warning text-dark">constructive algorithms</span>
  
    <span class="badge rounded-pill bg-warning text-dark">math</span>
  
    <span class="badge rounded-pill bg-warning text-dark">ternary search</span>
  
  </labels>
</div>

<p>Let’s look at coefficients of \(f(x)\), i.e. \(a_0, \ldots, a_{n-1}\).  Since we know that \(gcd(a_0, \ldots, a_{n-1}\) is \(1\) that means that there is some coefficient that is co-prime with \(p\) (if there weren’t that’d mean that all coefficients are divisible by \(p\) and hence we’d have \(gcd(a_0, \ldots, a_{n-1}) \ge p\)).  Now, let \(a_i\) be first of such coefficients, i.e. the one with smallest \(i\) fulfilling this condition.</p>

<p>For the same reasons we must have \(b_j\) in coefficients of \(g(x)\) that is not divisible by \(p\) with all \(b_0, \ldots b_{j-1}\) divisible by \(p\).</p>

<p>Now, let’s look at \(i+j\)‘th coefficient of \(h(x)\), it is:</p>

\[c_{i+j} = a_0 \cdot b_{i+j} + a_1 \cdot b_{i+j-1} + \ldots + a_{i-1} \cdot b_{j+1} + \underline{a_i \cdot b_j} + a_{i+1}\cdot b_{j-1} + \ldots + a_{i+j} \cdot b_0\]

<p>The important observation is that all elements of the sum other than the underlined one are divisible by \(p\).  The ones to the left of the underlined one are because \(a_0, \ldots a_{i-1}\) are all divisible by \(p\) and the ones to the right are divisible because all of \(b_0, \ldots b_{j-1}\) are.  Since \(a_i \cdot b_j\) itself is <em>not</em> divisible by \(p\), hence the whole sum isn’t and it is our answer.</p>


      </section>
    </div>
  </div>

   <footer>
  <a href="https://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
    <span>
        <b>Adam Koprowski</b>
    </span>
    
    <span>© 2021</span>
  </a>
</footer>

  
</body>

</html>
