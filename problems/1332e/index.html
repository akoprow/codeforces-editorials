<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"">
  <meta name="generator" content="Jekyll">

  <title>Height All the Same</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/codeforces-editorials/css/main.css">

  <link href="/codeforces-editorials/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Height All the Same | Codeforces editorials</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Height All the Same" />
<meta name="author" content="Adam Koprowski" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Codeforces editorials" />
<meta property="og:description" content="Codeforces editorials" />
<meta property="og:site_name" content="Codeforces editorials" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Height All the Same" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Height All the Same","url":"/codeforces-editorials/problems/1332e/","author":{"@type":"Person","name":"Adam Koprowski"},"description":"Codeforces editorials","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SHM3SPE7F9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SHM3SPE7F9');
  </script>
</head>


<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/codeforces-editorials/">
    
    <h1>adam@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/codeforces-editorials/"><h2 class="header-link">Contests</h2></a>
<a href="/codeforces-editorials/problems"><h2 class="header-link">Problems</h2></a>
<a href="/codeforces-editorials/todo"><h2 class="header-link">TODO</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <div class="alert alert-primary" role="alert">
  
  <tiny>1332</tiny>E

  
  <a href="/codeforces-editorials/problems/1332e/">
    Height All the Same
  </a>
  <a href="https://codeforces.com/contest/1332/problem/E">
  [CF]
  </a>

  <a href="https://github.com/akoprow/competetive-programming/blob/master/src/codeforces/r620-639/r630/1332e-height-all-the-same.kt">(Code)</a>

  <rating>R:2100 <meter min="800" max="3600" value="2100" /></rating>

  <labels>
  
  
    <span class="badge rounded-pill bg-warning text-dark">combinatorics</span>
  
    <span class="badge rounded-pill bg-warning text-dark">constructive algorithms</span>
  
    <span class="badge rounded-pill bg-warning text-dark">math</span>
  
    <span class="badge rounded-pill bg-warning text-dark">matrices</span>
  
  </labels>
</div>

<p>Ok, let’s try to understand what can we accomplish with the moves that we can do.</p>

<ul>
  <li>We can “+2” any cell we want.  That means that if all cells have the same parity then we win.</li>
  <li>We can “+1” two adjacent cells.  Based on the previous point we can realize that the actual values don’t matter, just the parity.  So this move allows us to change parity of two adjacent cells.  And by repeating it, that means we can change parity of two <strong>arbitrary</strong> cells.</li>
</ul>

<p>Let’s now think about the total number of cells, i.e. \(n \cdot m\).</p>

<p>If that number is odd we win no matter what.  Why?  Well, let’s count the number of cells with odd values, \(c_{odd}\), and the number of cells with even values, \(c_{even}\).  Since \(c_{odd} + c_{even} = n \cdot m\) is odd, then either of \(c_{odd}\)/\(c_{even}\) is odd and the other one is even.  Whichever group has an even number of cells we can change their parity using the second move type getting to a situation where all cells have the same parity, which we can solve with the first move type.</p>

<p>How many different grids there are?  Well, we have \(R-L+1\) different choices per cell and \(n \cdot m\) cells, so that gives us \(\mathcal{T} = (R-L+1)^{c \cdot m}\).</p>

<p>What if \(n \cdot m\) is even?  Clearly not all configurations lead to a victory here.  More precisely \(c_{odd} + c_{even} = n \cdot m\) is even, so either both \(c_{odd}\) and \(c_{even}\) are even, or they are both odd.  In the first situation we can easily win, using a similar argument to the one from the previous paragraph.  On the other hand, in the second case there is no way for us to win.</p>

<p>We have two options now.  We can try to write down and calculate a formula for the number of winning combinations.  That gets pretty tricky though.  There’s a clever shortcut we can use though.  The intuition is that across all boards roughly half of them gives us victory and half of them does not.</p>

<p>To convince yourself that that is true let’s try to pair up “good” and “bad” boards.  Firstly let’s assume that there is an equal number of even and odd numbers in our allowed range \([L, R]\), which is true whenever \(R-L+1\) is even.  In that case we can pair up all numbers in our range such that even numbers are paired with odd numbers.  Now take any board \(\mathcal{B}\) and replace its top-left most cell number with its paired number.  By doing so we changed the parity of that number and hence transformed a “good” board into “bad” or vice versa.  Either way this is the pairing we were looking for.  So we showed that half of the boards are good and therefore \(\frac{\mathcal{T}}{2}\) is our answer.</p>

<p>What if the \([L, R]\) range is not symmetrical?  This is a bit more difficult but we can actually show that all but one boards can be paired up.  We do a similar pairing to the one from the previous paragraph except:</p>

<ul>
  <li>We pair \(L\) with \(L+1\) etc. and only \(R\) remains unpaired.</li>
  <li>Instead of replacing top-leftmost corner we replace the first cell we encounter (in some predefined order) which is not equal to \(R\) and again we replace it with its pair.</li>
</ul>

<p>We can see that the only board that has no pair is the board where all cells contain \(R\). Such board is clearly a winning board (no moves required) so our final answer here is \(\frac{\mathcal{T}+1}{2}\).</p>


      </section>
    </div>
  </div>

   <footer>
  <a href="https://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
    <span>
        <b>Adam Koprowski</b>
    </span>
    
    <span>© 2021</span>
  </a>
</footer>

  
</body>

</html>
