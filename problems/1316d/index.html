<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"">
  <meta name="generator" content="Jekyll">

  <title>Nash Matrix</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="/codeforces-editorials/css/main.css">

  <link href="/codeforces-editorials/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Nash Matrix | Codeforces editorials</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Nash Matrix" />
<meta name="author" content="Adam Koprowski" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Codeforces editorials" />
<meta property="og:description" content="Codeforces editorials" />
<meta property="og:site_name" content="Codeforces editorials" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Nash Matrix" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Nash Matrix","url":"/codeforces-editorials/problems/1316d/","author":{"@type":"Person","name":"Adam Koprowski"},"description":"Codeforces editorials","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SHM3SPE7F9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SHM3SPE7F9');
  </script>
</head>


<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/codeforces-editorials/">
    
    <h1>adam@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/codeforces-editorials/"><h2 class="header-link">Contests</h2></a>
<a href="/codeforces-editorials/problems"><h2 class="header-link">Problems</h2></a>
<a href="/codeforces-editorials/todo"><h2 class="header-link">TODO</h2></a>

    </div>
  </div>
</header>
    <div class="container">
      <section id="main_content">
        <div class="alert alert-primary" role="alert">
  
  <tiny>1316</tiny>D

  
  <a href="/codeforces-editorials/problems/1316d/">
    Nash Matrix
  </a>
  <a href="https://codeforces.com/contest/1316/problem/D">
  [CF]
  </a>

  <a href="https://github.com/akoprow/competetive-programming/blob/master/src/codeforces/other/codeCraft20/1316d-mash-matrix.kt">(Code)</a>

  <rating>R:2000 <meter min="800" max="3600" value="2000" /></rating>

  <labels>
  
  
    <span class="badge rounded-pill bg-warning text-dark">constructive algorithms</span>
  
    <span class="badge rounded-pill bg-warning text-dark">dfs and similar</span>
  
    <span class="badge rounded-pill bg-warning text-dark">graphs</span>
  
    <span class="badge rounded-pill bg-warning text-dark">implementation</span>
  
  </labels>
</div>

<p>We have two types of cells: the one that have some target destination and the ones that need to be on a loop.  Let’s think about how to handle both those types.</p>

<p>For the target cells we can conceptually do the following: let’s pick some target \(T = (x, y)\). Let’s color all the cells with that target black and all the other ones white.  Now we can start at cell \(T\) and do a flood fill among black cells.  We put an \(X\) in the initial cell and if we move from \(C_1\) to neighbouring \(C_2\) then we put in \(C_2\) operation that will move it to \(C_1\).  The two crucial observations for this case were that: a) we want to move from the “sink” to all the other cells and b) that DFS is good enough and there’s no need for BFS or anything more complicated.</p>

<p>The loop case is even simpler. Every “looping” cell needs to point to some other “looping” cell.  If we can make such an assignment then we’re good.  We can easily prove by induction that this works and intuitively we can see that if every cell in that set directs to some other cell in that set, we can repeat this process ad infinitum and so we won’t ever stop.</p>

<p>At first I made it all quite a bit more complicated with some helper structures and such which was TLE-ing.  In fact the implementation can be made very simple with a single sweep across all cells and if we encounter:</p>

<ul>
  <li>a cell with a target \(T\) and cell \(T\) has not been processed yet then we process it with a flood fill as described above.  In particular cell \(T\) itself must point to itself and obtain an \(X\).</li>
  <li>a cell with a target \(T\) and cell \(T\) has a cross then its cluster was already processed.  If our cell has some direction assigned then we’re good.  If it hasn’t it means it wasn’t reached in the DFS of \(T\) and there is no answer.</li>
  <li>a looping cell then we direct it at any neighbour looping cell or give up if no such neighbour exists.</li>
</ul>


      </section>
    </div>
  </div>

   <footer>
  <a href="https://creativecommons.org/licenses/by-nc/3.0/deed.en_US">
    <span>
        <b>Adam Koprowski</b>
    </span>
    
    <span>© 2021</span>
  </a>
</footer>

  
</body>

</html>
