Just do as asked, keep map from number to its last index, or $$null$$ if it occurred more than once.  Then pick smallest non-null value in the map.
