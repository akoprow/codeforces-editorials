Observe that irreducible if either:

- length 1,
- first and last character different
- at last 3 different letters

The last constraint can be checked with prefix "sums" of character frequencies.
