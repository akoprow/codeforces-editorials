Simple greedy approach works.  I.e. at every step we consider next operation for first and second player and any move we can make we do make.  This is because all the moves either help us with further constraints (if we add a new line) or at least do not hinder it (if we modify a line).  If we manage to process all the moves then we're good; if at any point neither programmer can make progress the answer must be "NO".
