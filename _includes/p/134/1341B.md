We have a constant time check to see if a given index is a peak or not.  So we just maintain a window of size $$k$$ and count the number of peaks within the window.  Moving to the next index one position falls out of our window and one falls into it so we need to do at most two updates to our set of peaks.  Careful with off-by-one errors due to boundary conditions! (segment boundary never counts as a peak)
