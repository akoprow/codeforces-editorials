We can do it in one pass: consider all blocks of problems (i.e. ignore a problem if it's the same as the previous one, meaning it belongs to the same block).  Now if any problem has at least $$2$$ groups then the teacher can be suspicious.

Alternatively, for every problem find its first and last occurrence.  All the positions in between must also belong to that problem or else the teacher can be suspicious.
