Just simulate. Store segments on a heap sorted lexicographically by length, then start.
